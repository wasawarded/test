Countifs
مع
منطق
OR
لمعايير
متعددة
في
Excel
المؤلف:
شياويانغ
آخر
تعديل:
2024-09-29
عادةً
،
يمكنك
استخدام
وظيفة
COUNTIFS
لحساب
عدد
الخلايا
بناءً
على
شرط
واحد
أو
أكثر
باستخدام
منطق
AND
في
Excel.
هل
سبق
لك
أن
واجهت
موقفًا
تحتاج
فيه
إلى
حساب
أكثر
من
قيمة
من
عمود
واحد
أو
نطاق
من
الخلايا؟
هذا
يعني
العد
بشروط
متعددة
ومنطق
OR.
في
هذه
الحالة
،
يمكنك
تطبيق
الدالتين
SUM
و
COUNTIFS
معًا
،
أو
استخدام
الدالة
SUMPRODUCT.
doc-countifs-مع-أو-المنطق-1
عد
الخلايا
بشروط
"أو"
في
Excel
--
على
سبيل
المثال
،
لدي
مجموعة
من
البيانات
كما
هو
موضح
أدناه
،
أريد
حساب
رقم
المنتج
الذي
هو
"Pencil"
أو
"Ruler"
،
هنا
،
سأناقش
صيغتين
لحل
هذه
المهمة
في
Excel.
doc-countifs-مع-أو-المنطق-2
عد
الخلايا
بشروط
"أو"
باستخدام
الدالتين
SUM
و
COUNTIFS
--
=SUM(COUNTIFS(B2:B13,{"Pencil","Ruler"}))
doc-countifs-مع-أو-المنطق-3
شرح
الصيغة:
--
=SUM(COUNTIF(B2:B13,D2:D3))
doc-countifs-مع-أو-المنطق-4
عد
الخلايا
بشروط
أو
باستخدام
الدالة
SUMPRODUCT
فيما
يلي
صيغة
أخرى
تم
إنشاؤها
بواسطة
الدالة
SUMPRODUCT
والتي
يمكن
أن
تساعد
في
حساب
الخلايا
باستخدام
منطق
OR
أيضًا.
الصيغة
العامة
هي:
=SUMPRODUCT(1*(range
={criterion1,
criterion2,
criterion3,
…}))
--
=SUMPRODUCT(1*(B2:B13={"Pencil","Ruler"}))
doc-countifs-مع-أو-المنطق-5
شرح
الصيغة:
--
B2:
B13
=
{"Pencil"،
"Ruler"}:
يقارن
هذا
التعبير
كل
معيار
"Pencil"
و
"Ruler"
بخلية
النطاق
B2:
B13.
إذا
تم
استيفاء
المعيار
،
فإنه
يُرجع
قيمة
TRUE
،
وإلا
فسيتم
عرض
FALSE
،
ستحصل
على
النتيجة
على
النحو
التالي:
{TRUE،
FALSE؛
FALSE،
FALSE؛
FALSE،
FALSE؛
FALSE،
TRUE؛
FALSE،
FALSE؛
TRUE،
FALSE
؛
FALSE،
FALSE؛
FALSE،
TRUE؛
FALSE،
FALSE؛
FALSE،
FALSE؛
FALSE،
TRUE؛
FALSE،
FALSE}.
1
*
(B2:
B13
=
{"Pencil"،
"Ruler"}):
يحول
الضرب
القيم
المنطقية
-
TRUE
و
FALSE
إلى
1
و
0
،
لذلك
ستحصل
على
النتيجة
مثل
هذه:
{1,0،0,0؛
0,0،0,1؛
0,0،1,0؛
0,0،0,1؛
0,0،0,0؛
0,1،0,0؛
XNUMX
،
XNUMX؛
XNUMX،XNUMX؛
XNUMX،XNUMX؛
XNUMX،XNUMX؛
XNUMX،XNUMX؛
XNUMX،XNUMX}.
SUMPRODUCT(1*(B2:B13={"Pencil","Ruler"}))=
SUMPRODUCT({1,0;0,0;0,0;0,1;0,0;1,0;0,0;0,1;0,0;0,0;0,1;0,0}):
أخيرًا
،
تجمع
الدالة
SUMPRODUCT
جميع
الأرقام
في
المصفوفة
للحصول
على
النتيجة:
5.
--
على
سبيل
المثال
،
لدي
نطاق
البيانات
كما
هو
موضح
أدناه
،
أريد
حساب
الأشخاص
الذين
طلبوا
"Pencil"
أو
"Ruler"
والمبلغ
إما
<100
أو>
200.
doc-countifs-مع-أو-المنطق-6
الرجاء
إدخال
الصيغة
التالية
أو
نسخها
في
خلية
،
ثم
الضغط
على
أدخل
مفتاح
للحصول
على
النتيجة
،
انظر
لقطة
الشاشة:
--
ملاحظات:
في
الصيغة
،
يجب
استخدام
فاصلة
منقوطة
لثابت
الصفيف
الثاني
،
مما
يؤدي
إلى
إنشاء
صفيف
عمودي.
doc-countifs-مع-أو-المنطق-7
عد
الخلايا
بمجموعات
متعددة
من
شروط
OR
باستخدام
الدالة
SUMPRODUCT
--
خذ
البيانات
أدناه
على
سبيل
المثال
،
لحساب
الأشخاص
الذين
طلبوا
"Pencil"
أو
"Ruler"
وكانت
الحالة
إما
"Delivered"
أو
"In
Transition"
وموقعة
بواسطة
"Bob"
أو
"Eko"
،
يجب
تطبيق
صيغة
معقدة
.
doc-countifs-مع-أو-المنطق-8
يُرجى
نسخ
الصيغة
أدناه
أو
إدخالها
في
خلية
فارغة
،
ثم
الضغط
على
أدخل
مفتاح
للحصول
على
الحساب
،
انظر
الصورة:
=SUMPRODUCT(ISNUMBER(MATCH(B2:B13,{"Pencil","Ruler"},0))*ISNUMBER(MATCH(C2:C13,{"Delivered","In
transit"},0))*ISNUMBER(MATCH(D2:D13,{"Bob","Eko"},0)))
doc-countifs-مع-أو-المنطق-9
شرح
الصيغة:
--
ISNUMBER(MATCH(B2:B13,{"Pencil","Ruler"},0))=
ISNUMBER({1;#N/A;#N/A;2;#N/A;1;#N/A;2;1;#N/A;2;#N/A}):
تحول
الدالة
ISNUMBER
الأرقام
إلى
صواب
وقيم
خطأ
على
النحو
التالي:
{TRUE؛
FALSE؛
FALSE؛
TRUE؛
FALSE؛
TRUE؛
FALSE؛
TRUE؛
TRUE؛
FALSE؛
TRUE؛
FALSE}.
يمكن
أيضًا
تطبيق
المنطق
أعلاه
على
تعبيري
ISNUMBER
الثاني
والثالث.
SUMPRODUCT(ISNUMBER(MATCH(B2:B13,{"Pencil","Ruler"},0))*ISNUMBER(MATCH(C2:C13,{"Delivered","In
transit"},0))*ISNUMBER(MATCH(D2:D13,{"Bob","Eko"},0))):
--
عد
عدد
الصفوف
ذات
معايير
أو
متعددة
لحساب
عدد
الصفوف
ذات
المعايير
المتعددة
في
أعمدة
مختلفة
،
باستخدام
منطق
OR
،
يمكن
أن
تساعدك
الدالة
SUMPRODUCT.
على
سبيل
المثال
،
لدي
تقرير
منتج
كما
هو
موضح
أدناه
،
أريد
حساب
الصفوف
التي
يكون
فيها
المنتج
"تي
شيرت"
أو
اللون
"أسود".
كيف
تتعامل
مع
هذه
المهمة
في
Excel؟
أفضل
أدوات
إنتاجية
المكتب
